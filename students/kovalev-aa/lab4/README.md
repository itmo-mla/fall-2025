# Лабораторная 4. PCA

## Тема работы
Метод главных компонент (PCA) и его реализация через сингулярное разложение (SVD).

---

## Цель работы
Целью данной лабораторной работы является изучение метода главных компонент, его практической реализации через сингулярное разложение, а также анализ структуры реальных данных и определение их эффективной размерности. Дополнительно проводится сравнение собственной реализации PCA с эталонной реализацией из библиотеки `scikit-learn`.

---

## Постановка задачи
В рамках работы необходимо:
1. Выбрать датасет для линейной регрессии.
2. Реализовать алгоритм PCA через сингулярное разложение (SVD).
3. Определить эффективную размерность выборки.
4. Показать эквивалентность собственной реализации PCA с эталонной реализацией из `sklearn`.
5. Подготовить отчет по результатам экспериментов.

---

## Описание используемого датасета
В работе используется реальный датасет **Wine Dataset** из репозитория UCI, доступный через `sklearn.datasets.load_wine`.

Основные характеристики датасета:
- количество объектов: 178
- количество признаков: 13
- количество классов: 3
- признаки описывают физико-химические свойства вин (содержание алкоголя, фенолов, магния, оттенок цвета и др.)

Данный датасет является типичным примером многомерных коррелированных данных, что делает его подходящим для применения метода главных компонент.

Перед применением PCA данные были стандартизированы с использованием `StandardScaler`, что является обязательным этапом при анализе признаков, измеренных в различных шкалах.

---

## Реализация метода PCA
Метод главных компонент реализован в классе `CustomPCA`. В основе реализации лежит сингулярное разложение центрированной матрицы данных:

X = U · S · Vᵀ

Главные компоненты определяются строками матрицы Vᵀ. Дисперсия, объясняемая каждой компонентой, вычисляется на основе сингулярных значений S.

Дополнительно была введена процедура фиксации знака компонент. Поскольку направление главных компонент в PCA не определяется однозначно, результаты разных реализаций могут отличаться знаком. Для обеспечения визуального и численного сходства с реализацией `sklearn` знак каждой компоненты выбирается так, чтобы элемент с максимальным модулем был положительным. Данная операция не влияет на геометрию данных и объясненную дисперсию.

---

## Сравнение с эталонной реализацией
Для проверки корректности собственной реализации было проведено сравнение с реализацией `sklearn.decomposition.PCA`.

Сравнение показало:
- коэффициенты главных компонент полностью совпадают с результатами `sklearn`;
- проекции данных на первые две главные компоненты эквивалентны;
- визуализация результатов подтверждает совпадение геометрии проекций.

Таким образом, реализованный алгоритм PCA является эквивалентным эталонной реализации.

---

## Определение эффективной размерности
Эффективная размерность данных оценивалась двумя способами:

1. **По накопленной объясненной дисперсии** — минимальное число главных компонент, суммарно объясняющих не менее 95% дисперсии данных.
2. **По критерию Марченко–Пастура** — число собственных значений ковариационной матрицы, превышающих порог λ > 1.

В результате эксперимента получены следующие значения:
- эффективная размерность по критерию Марченко–Пастура: 3;
- эффективная размерность по порогу 95% энергии: 10.

Полученные результаты указывают на то, что основная структура данных определяется сравнительно малым числом факторов, несмотря на исходную размерность пространства признаков.

---

## Визуализация результатов
Для наглядного сравнения были построены двумерные проекции данных на первые две главные компоненты для собственной реализации PCA и реализации `sklearn`. Визуализация подтверждает совпадение ориентации и формы облаков точек.

---

## Выводы
В ходе выполнения лабораторной работы:
- был выбран и проанализирован реальный многомерный датасет;
- реализован метод главных компонент через сингулярное разложение;
- показана эквивалентность собственной реализации PCA и реализации из `scikit-learn`;
- определена эффективная размерность выборки различными методами;
- подтверждена возможность существенного снижения размерности данных без значительной потери информации.

Метод главных компонент является эффективным инструментом анализа структуры данных и снижения размерности, что подтверждается полученными экспериментальными результатами.
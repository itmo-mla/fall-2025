# Лабораторная работа: Метрические методы классификации и регрессии

## Описание работы

В данной лабораторной работе исследуются метрические методы классификации, в частности **метод Парзена с переменной шириной окна** и **метод отбора эталонов (prototype learning)**. Работа выполнена на классическом датасете **"Ирисы Фишера" (Iris dataset)**.

## Датасет Iris

Датасет содержит **150 образцов ирисов**, каждый из которых описан **4 признаками**:

| Признак | Описание |
|---------|----------|
| Длина чашелистика | sepal length |
| Ширина чашелистика | sepal width |
| Длина лепестка | petal length |
| Ширина лепестка | petal width |

**Образцы разделены на 3 класса:**

- **0**: Iris Setosa
- **1**: Iris Versicolor  
- **2**: Iris Virginica

## Реализованные методы

### 1. Метод Парзена переменной ширины
Реализован алгоритм классификации с использованием **гауссова ядра** и **переменной ширины окна**, где ширина окна определяется расстоянием до **(k+1)-го ближайшего соседа**.

### 2. Отбор эталонов (Prototype Learning)
Реализован **жадный алгоритм отбора эталонов** на основе эмпирического риска 1NN, позволяющий значительно уменьшить количество объектов для классификации без существенной потери точности.

## Результаты

### Эмпирический риск на исходных данных

![Эмпирический риск на всех данных](source/images/EmperikRiskAllData.png)

*На графике показана зависимость эмпирического риска (ошибки LOO) от параметра k для метода Парзена на полной выборке. Оптимальное значение k было подобрано методом скользящего контроля.*

---

### Точность классификации на исходных данных

![Точность на всех данных](source/images/AccuracyAllData.png)

*Сравнение точности классификации метода Парзена и эталонной реализации KNN из sklearn на полной выборке.*

---

### Визуализация отбора эталонов в PCA пространстве

![Визуализация эталонов](source/images/EmperikVisualize.png)

*Визуализация показывает результат отбора эталонов в двумерном PCA пространстве:*
- **Серые точки**: удалённые объекты
- **Цветные точки**: отобранные эталоны

---

### Эмпирический риск на эталонах

![Эмпирический риск на эталонах](source/images/emperickriskEtalons.png)

*Зависимость эмпирического риска от k для метода Парзена на отобранных эталонах.*

---

### Точность классификации на эталонах

![Точность на эталонах](source/images/AccuracyEtalon.png)

*Сравнение точности классификации на отобранных эталонах методом Парзена и sklearn KNN.*

---

## Выводы

| Аспект | Результат |
|--------|-----------|
| **Эффективность отбора эталонов** | Метод позволил сократить количество объектов с 120 до ~30-40 (удаление 70-75% объектов) при сохранении точности в пределах 2-3% отклонения |
| **Качество метода Парзена** | Реализованный метод показывает точность, сопоставимую с эталонной реализацией KNN из библиотеки sklearn |
| **Вычислительная эффективность** | Использование эталонов ускоряет классификацию в 3-4 раза за счёт уменьшения количества вычисляемых расстояний |
| **Адаптивность метода Парзена** | Метод переменной ширины окна автоматически адаптируется к локальной плотности данных |
| **Визуальная интерпретируемость** | PCA визуализация показывает, что эталоны расположены на границах классов и в центрах кластеров |

## Заключение

Работа подтвердила **эффективность метрических методов** для задач классификации и показала, что **отбор эталонов** является мощным инструментом для сжатия данных без существенной потери информации. Реализованный метод Парзена переменной ширины демонстрирует хорошие результаты и может быть использован в реальных задачах машинного обучения.

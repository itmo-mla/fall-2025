# Лабораторная работа №5

## Задание

1. выбрать датасет для логистической регрессии;
2. реализовать логистическую регрессию с помощью метода Ньютона-Рафсона и IRLS;
3. показать эквивалентность с эталонной реализацией;
4. подготовить отчет.

## Отчёт

### 1. Датасет

В качестве датасета выбран breast-cancer dataset.

### 2. Программная реализация

Структура проекта:
```
lab5/
├── source/
│   ├── LogisticRegressiion.py   # Основная реализация логистической регрессии
└── lab5.ipynb                   # Анализ, визуализация, сравнение с эталоном
└── README.md
```

В программе реализовано:
* **Логистическая регрессия методом Ньютона-Рафсона** — [исходный код](source/LogisticRegressiion.py)
* **Логистическая регрессия методом IRLS** — [исходный код](source/LogisticRegressiion.py)
* **Сравнение с эталонной реализацией (sklearn LogisticRegression)** — [исходный код](lab5.ipynb)

#### Реализация метода Ньютона-Рафсона:
```python
def _newton_step(self, X, y, sigma):
    grad = -X.T @ (y / sigma)
    d = np.diag(sigma * (1 - sigma))
    hessian = X.T @ d @ X
    hessian += 1e-8 * np.eye(hessian.shape[0])
    delta = np.linalg.inv(hessian) @ grad
    self.w -= self.learning_rate * delta
```

#### Реализация метода IRLS:
```python
def _irls_step(self, X, y, sigma):
    gamma = np.sqrt(sigma * (1 - sigma))

    X_mod = np.diag(gamma) @ X
    y_mod = y * (gamma / sigma)

    self.w += self.lern_rate * (np.linalg.inv(X_mod.T @ X_mod) @ X_mod.T @ y_mod)
```

### 3. Анализ и сравнение
Сравнение с эталонной реализацией из библиотеки sklearn LogisticRegression проведено на тестовом наборе данных.

**Результаты:**
```
Accuracy (sklearn): 0.9385964912280702
Accuracy (Newton's method): 0.9473684210526315
Accuracy (IRLS): 0.9385964912280702
```

Все три метода показали сопоставимые результаты по точности классификации на тестовом наборе данных. Newton's method показал немного лучшую точность по сравнению с IRLS и sklearn LogisticRegression, что может быть связано с особенностями конкретного датасета и инициализацией весов.

### Вывод

Реализованы два метода оптимизации для логистической регрессии: метод Ньютона-Рафсона и метод IRLS. Проведено сравнение с эталонной реализацией из библиотеки sklearn, показавшее сопоставимые результаты по точности классификации.
